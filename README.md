# Mat Code 及其破译

## Mat Code

### 秘钥交换(MCKE)

#### Diffie-Hellman Key Exchange

Whitefield与Martin Hellman在1976年提出了一个奇妙的密钥交换协议,称为Diffie-Hellman密钥交换协议/算法(Diffie-Hellman Key Exchange/Agreement Algorithm).这个机制的巧妙在于需要安全通信的双方可以用这个方法确定对称密钥.然后可以用这个密钥进行加密和解密.

#### 该方法在矩阵形式下依然成立

经CPY证明，该方法对于矩阵依然适用

#### 原理:模算术下求矩阵对数不易

CPY估计，模算术下求矩阵对数不易，甚至比模算术下求实数对数更不易

### 加密算法

#### 直接书写—便捷

该算法属于置换密码，采用矩阵秘钥板可直接书写不需计算或多次抄写

#### 旋转操作—增大安全度

旋转操作可以增强密码的安全度，使单词被打乱，干扰直接观看者

### 破译

#### 对交换秘钥算法(MCKE)攻击

1.矩阵模算术下的对数难以求解

2.由Diffie-Hellman方法的矩阵形式性质可知，攻击交换秘钥算法较为困难

#### 对秘钥攻击

1.根据秘钥构造法可得，密钥数为4^(n^2)，密钥总数较大，难以在可行时间内遍历

2.还原的明文组合多，无法判断何为正确

#### 对密文攻击

**Step1 建立字典(Trie树)**

构建支持输入、查询的Trie树，输入常用单词字典

**Step2 DFS搜索钥匙片段**

搜索单词

搜索密文格子，按照Trie树的结构分析该格子中的字母加入后秘钥片段对应的格子是否是一个单词的一部分，可以则加入

判断片段是否合法

钥匙片段添加新格子时要。判断该格子是否会被之前存在的格子通过旋转操作得到，可以则不能加入

**Step3 钥匙片段的合并**

最长公共子序列判断重合

通过旋转操作后队列的最长公共子序列来判断两片段的重合程度，最长公共子序列可转化为最长不降子序列在O(nlogn)时间内解决

判断两片段是否重合或矛盾

通过旋转操作判断两片段是否存在两个格子永远无法兼顾而发生矛盾

并查集维护总钥匙片段与合成数

对于不发生矛盾且重合多的片段进行合并，用并查集维护一个可合成钥匙片段集合合成的总钥匙片段与集合内钥匙片段数

**Step4 保存疑似钥匙**

留档保存，为机器操作准备

输出，为人工操作准备

**Step5 用疑似钥匙片段解密**

清点单词错误

用疑似钥匙片段解密密文，在Trie树上查找，计算不可能存在的字母组合个数，必要时可构建AC自动机增速

**Step6 补足剩余位**

机器操作：机器搜索解密后的密文中不能构成单词的字母段，与剩余字母比较试验，补充剩余秘钥位，机器主观能力差，该方法用机器实现较困难

人工操作：人工试验寻找合适字母补充剩余位，人具有较强主观能力，而这个工作计算力需求小，故可以很好的胜任这个工作

**Step7 输出疑似明文与秘钥**

将补足剩余位的疑似明文及其所对应的秘钥保存并输出

**Step8 人工判断疑似明文真伪**

用语言连贯性等判据判断明文的真实性

**Step9 确定明文与秘钥**

对于判断为真实的明文，记录其对应的秘钥，用该秘钥解密其他信息
